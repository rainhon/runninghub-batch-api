import{w as T,y as w,a as r,p as e}from"./chunk-WWGJGFF6-nyOa09Sz.js";import{c as C,B as i}from"./createLucideIcon-DtgM1CL6.js";import{b as u,B as b,a as p}from"./api-BhhqYs-Z.js";import{C as k,a as S,b as B,c as D,d as I}from"./card-Df6hLeyZ.js";import{R as M,T as R,a as H,b as f,c as a,d as L,e as t}from"./table-BNpnYNON.js";import{P}from"./plus-Bi-xtxpj.js";import{F as z}from"./file-text-976nw4IX.js";import"./index-DwmZqWTl.js";const E=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],F=C("trash-2",E),W=T(function(){const l=w(),[c,g]=r.useState([]),[N,o]=r.useState(!0),[x,m]=r.useState(!1),[V,_]=r.useState(null),[h,j]=r.useState(null),d=async(s=!1)=>{try{s?m(!0):o(!0);const n=await p.getTemplates();g(n.data||[])}catch(n){console.error("加载模板列表失败:",n.message)}finally{o(!1),m(!1)}},v=s=>{l("/create",{state:{template:s}})},y=async s=>{j(s);try{await p.deleteTemplate(s),await d()}catch(n){console.error("删除模板失败:",n.message)}finally{j(null)}};return r.useEffect(()=>{d()},[]),e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"任务模板"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"管理和使用任务模板"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{variant:"outline",onClick:()=>d(!0),disabled:x,children:[e.jsx(M,{className:`w-4 h-4 mr-2 ${x?"animate-spin":""}`}),"刷新"]}),e.jsxs(i,{onClick:()=>l("/create"),children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"创建任务"]})]})]}),e.jsxs(k,{children:[e.jsxs(S,{children:[e.jsx(B,{children:"模板列表"}),e.jsxs(D,{children:["当前共有 ",c.length," 个模板"]})]}),e.jsx(I,{children:N?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(u,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(z,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"暂无模板"}),e.jsx(i,{onClick:()=>l("/create"),children:"创建第一个模板"})]}):e.jsxs(R,{children:[e.jsx(H,{children:e.jsxs(f,{children:[e.jsx(a,{className:"w-20",children:"ID"}),e.jsx(a,{children:"模板名称"}),e.jsx(a,{children:"App ID"}),e.jsx(a,{children:"节点数"}),e.jsx(a,{children:"重复次数"}),e.jsx(a,{children:"创建时间"}),e.jsx(a,{className:"w-32",children:"操作"})]})}),e.jsx(L,{children:c.map(s=>e.jsxs(f,{children:[e.jsx(t,{className:"font-mono text-sm",children:s.id}),e.jsx(t,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),s.description&&e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:s.description})]})}),e.jsx(t,{className:"font-mono text-sm",children:s.appId}),e.jsx(t,{children:e.jsx(b,{variant:"secondary",children:s.nodes.length})}),e.jsx(t,{children:s.repeatCount}),e.jsx(t,{className:"text-sm text-muted-foreground",children:new Date(s.createdAt).toLocaleString("zh-CN")}),e.jsx(t,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>v(s),children:"使用"}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>y(s.id),disabled:h===s.id,children:h===s.id?e.jsx(u,{className:"w-4 h-4 animate-spin"}):e.jsx(F,{className:"w-4 h-4"})})]})})]},s.id))})]})})]})]})});export{W as default};
